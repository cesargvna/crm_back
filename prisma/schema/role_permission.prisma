model PermissionSection {
  id         String        @id @default(uuid()) @db.VarChar(255)
  name       String        @unique @db.VarChar(100)
  order      Int           @unique @default(0)
  status     Boolean       @default(true)

  modules    ModuleGroup[]
  rolePermissions RolePermission[] // ✅ Enlace a permisos

  created_at DateTime      @default(now())
  updated_at DateTime      @updatedAt

}

model ModuleGroup {
  id         String        @id @default(uuid()) @db.VarChar(255)
  name       String        @db.VarChar(100)
  route      String        @db.VarChar(255)
  iconName   String        @db.VarChar(100)
  status     Boolean       @default(true)

  sectionId  String        @db.VarChar(255)
  section    PermissionSection @relation(fields: [sectionId], references: [id])

  submodules SubmoduleGroup[]

   @@unique([name, sectionId])

  created_at DateTime      @default(now())
  updated_at DateTime      @updatedAt
}

model SubmoduleGroup {
  id         String        @id @default(uuid()) @db.VarChar(255)
  name       String        @db.VarChar(100)
  route      String        @db.VarChar(255)
  status     Boolean       @default(true)

  moduleId   String        @db.VarChar(255)
  module     ModuleGroup   @relation(fields: [moduleId], references: [id])

  @@unique([name, moduleId])

  created_at DateTime      @default(now())
  updated_at DateTime      @updatedAt
}

model PermissionAction {
  id         String        @id @default(uuid()) @db.VarChar(255)
  name       String        @unique @db.VarChar(50)

  rolePermissions RolePermission[]

  created_at DateTime      @default(now())
  updated_at DateTime      @updatedAt

}

model Role {
  id              String        @id @default(uuid()) @db.VarChar(255)
  name            String        @db.VarChar(100)
  description     String?       @db.VarChar(255)
  status          Boolean       @default(true)

  rolePermissions RolePermission[]
  users User[]

  created_at      DateTime      @default(now())
  updated_at      DateTime      @updatedAt

  tenantId        String?        @db.VarChar(255) // ✅ agregado
  @@index([tenantId])
  @@unique([name, tenantId])
}

model RolePermission {
  id            String           @id @default(uuid()) @db.VarChar(255)

  roleId        String           @db.VarChar(255)
  actionId      String           @db.VarChar(255)
  sectionId     String           @db.VarChar(255)  // ✅ Solo enlazado a la sección

  role          Role             @relation(fields: [roleId], references: [id])
  action        PermissionAction @relation(fields: [actionId], references: [id])
  section       PermissionSection @relation(fields: [sectionId], references: [id])

  created_at    DateTime         @default(now())
  updated_at    DateTime         @updatedAt

  @@unique([roleId, actionId, sectionId])

  tenantId        String        @db.VarChar(255) // ✅ agregado
  @@index([tenantId])
}
